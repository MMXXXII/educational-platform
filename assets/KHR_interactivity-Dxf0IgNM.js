const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/flowGraphCodeExecutionBlock-rGFMQEYc.js","assets/sceneFragmentDeclaration-CNWtVIbJ.js","assets/flowGraphGLTFDataProvider-_4JvEaCu.js"])))=>i.map(i=>d[i]);
import{_ as a,bl as at,bm as j,bn as U,bo as rt,L as F,bp as $,bq as et,a4 as Y,V as nt}from"./sceneFragmentDeclaration-CNWtVIbJ.js";import{u as ct,r as it}from"./model-viewer-CRf71ZHW.js";import{a as st,A as R}from"./objectModelMapping-DZbRXB0J.js";import{g as lt,a as z}from"./declarationMapper-BB1D8Xqx.js";import"./with-props-CdbLO-WJ.js";import"./chunk-AYJ5UCUI-B1579ApN.js";import"./waterMaterial-DHEJP-Do.js";const Z={};function pt(e,t,o){Z[`${e}/${t}`]=o}function ut(e){switch(e){case"FlowGraphPlayAnimationBlock":return async()=>(await a(async()=>{const{FlowGraphPlayAnimationBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bN);return{FlowGraphPlayAnimationBlock:t}},[])).FlowGraphPlayAnimationBlock;case"FlowGraphStopAnimationBlock":return async()=>(await a(async()=>{const{FlowGraphStopAnimationBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bO);return{FlowGraphStopAnimationBlock:t}},[])).FlowGraphStopAnimationBlock;case"FlowGraphPauseAnimationBlock":return async()=>(await a(async()=>{const{FlowGraphPauseAnimationBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bP);return{FlowGraphPauseAnimationBlock:t}},[])).FlowGraphPauseAnimationBlock;case"FlowGraphInterpolationBlock":return async()=>(await a(async()=>{const{FlowGraphInterpolationBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bQ);return{FlowGraphInterpolationBlock:t}},[])).FlowGraphInterpolationBlock;case"FlowGraphSceneReadyEventBlock":return async()=>(await a(async()=>{const{FlowGraphSceneReadyEventBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.cb);return{FlowGraphSceneReadyEventBlock:t}},[])).FlowGraphSceneReadyEventBlock;case"FlowGraphSceneTickEventBlock":return async()=>(await a(async()=>{const{FlowGraphSceneTickEventBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.ce);return{FlowGraphSceneTickEventBlock:t}},[])).FlowGraphSceneTickEventBlock;case"FlowGraphSendCustomEventBlock":return async()=>(await a(async()=>{const{FlowGraphSendCustomEventBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.cd);return{FlowGraphSendCustomEventBlock:t}},[])).FlowGraphSendCustomEventBlock;case"FlowGraphReceiveCustomEventBlock":return async()=>(await a(async()=>{const{FlowGraphReceiveCustomEventBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.cc);return{FlowGraphReceiveCustomEventBlock:t}},[])).FlowGraphReceiveCustomEventBlock;case"FlowGraphMeshPickEventBlock":return async()=>(await a(async()=>{const{FlowGraphMeshPickEventBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.ca);return{FlowGraphMeshPickEventBlock:t}},[])).FlowGraphMeshPickEventBlock;case"FlowGraphEBlock":return async()=>(await a(async()=>{const{FlowGraphEBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphEBlock:t}},[])).FlowGraphEBlock;case"FlowGraphPIBlock":return async()=>(await a(async()=>{const{FlowGraphPiBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphPiBlock:t}},[])).FlowGraphPiBlock;case"FlowGraphInfBlock":return async()=>(await a(async()=>{const{FlowGraphInfBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphInfBlock:t}},[])).FlowGraphInfBlock;case"FlowGraphNaNBlock":return async()=>(await a(async()=>{const{FlowGraphNaNBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphNaNBlock:t}},[])).FlowGraphNaNBlock;case"FlowGraphRandomBlock":return async()=>(await a(async()=>{const{FlowGraphRandomBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphRandomBlock:t}},[])).FlowGraphRandomBlock;case"FlowGraphAddBlock":return async()=>(await a(async()=>{const{FlowGraphAddBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphAddBlock:t}},[])).FlowGraphAddBlock;case"FlowGraphSubtractBlock":return async()=>(await a(async()=>{const{FlowGraphSubtractBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphSubtractBlock:t}},[])).FlowGraphSubtractBlock;case"FlowGraphMultiplyBlock":return async()=>(await a(async()=>{const{FlowGraphMultiplyBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphMultiplyBlock:t}},[])).FlowGraphMultiplyBlock;case"FlowGraphDivideBlock":return async()=>(await a(async()=>{const{FlowGraphDivideBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphDivideBlock:t}},[])).FlowGraphDivideBlock;case"FlowGraphAbsBlock":return async()=>(await a(async()=>{const{FlowGraphAbsBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphAbsBlock:t}},[])).FlowGraphAbsBlock;case"FlowGraphSignBlock":return async()=>(await a(async()=>{const{FlowGraphSignBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphSignBlock:t}},[])).FlowGraphSignBlock;case"FlowGraphTruncBlock":return async()=>(await a(async()=>{const{FlowGraphTruncBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphTruncBlock:t}},[])).FlowGraphTruncBlock;case"FlowGraphFloorBlock":return async()=>(await a(async()=>{const{FlowGraphFloorBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphFloorBlock:t}},[])).FlowGraphFloorBlock;case"FlowGraphCeilBlock":return async()=>(await a(async()=>{const{FlowGraphCeilBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphCeilBlock:t}},[])).FlowGraphCeilBlock;case"FlowGraphRoundBlock":return async()=>(await a(async()=>{const{FlowGraphRoundBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphRoundBlock:t}},[])).FlowGraphRoundBlock;case"FlowGraphFractBlock":return async()=>(await a(async()=>{const{FlowGraphFractionBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphFractionBlock:t}},[])).FlowGraphFractionBlock;case"FlowGraphNegationBlock":return async()=>(await a(async()=>{const{FlowGraphNegationBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphNegationBlock:t}},[])).FlowGraphNegationBlock;case"FlowGraphModuloBlock":return async()=>(await a(async()=>{const{FlowGraphModuloBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphModuloBlock:t}},[])).FlowGraphModuloBlock;case"FlowGraphMinBlock":return async()=>(await a(async()=>{const{FlowGraphMinBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphMinBlock:t}},[])).FlowGraphMinBlock;case"FlowGraphMaxBlock":return async()=>(await a(async()=>{const{FlowGraphMaxBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphMaxBlock:t}},[])).FlowGraphMaxBlock;case"FlowGraphClampBlock":return async()=>(await a(async()=>{const{FlowGraphClampBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphClampBlock:t}},[])).FlowGraphClampBlock;case"FlowGraphSaturateBlock":return async()=>(await a(async()=>{const{FlowGraphSaturateBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphSaturateBlock:t}},[])).FlowGraphSaturateBlock;case"FlowGraphMathInterpolationBlock":return async()=>(await a(async()=>{const{FlowGraphMathInterpolationBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphMathInterpolationBlock:t}},[])).FlowGraphMathInterpolationBlock;case"FlowGraphEqualityBlock":return async()=>(await a(async()=>{const{FlowGraphEqualityBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphEqualityBlock:t}},[])).FlowGraphEqualityBlock;case"FlowGraphLessThanBlock":return async()=>(await a(async()=>{const{FlowGraphLessThanBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphLessThanBlock:t}},[])).FlowGraphLessThanBlock;case"FlowGraphLessThanOrEqualBlock":return async()=>(await a(async()=>{const{FlowGraphLessThanOrEqualBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphLessThanOrEqualBlock:t}},[])).FlowGraphLessThanOrEqualBlock;case"FlowGraphGreaterThanBlock":return async()=>(await a(async()=>{const{FlowGraphGreaterThanBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphGreaterThanBlock:t}},[])).FlowGraphGreaterThanBlock;case"FlowGraphGreaterThanOrEqualBlock":return async()=>(await a(async()=>{const{FlowGraphGreaterThanOrEqualBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphGreaterThanOrEqualBlock:t}},[])).FlowGraphGreaterThanOrEqualBlock;case"FlowGraphIsNaNBlock":return async()=>(await a(async()=>{const{FlowGraphIsNanBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphIsNanBlock:t}},[])).FlowGraphIsNanBlock;case"FlowGraphIsInfBlock":return async()=>(await a(async()=>{const{FlowGraphIsInfinityBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphIsInfinityBlock:t}},[])).FlowGraphIsInfinityBlock;case"FlowGraphDegToRadBlock":return async()=>(await a(async()=>{const{FlowGraphDegToRadBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphDegToRadBlock:t}},[])).FlowGraphDegToRadBlock;case"FlowGraphRadToDegBlock":return async()=>(await a(async()=>{const{FlowGraphRadToDegBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphRadToDegBlock:t}},[])).FlowGraphRadToDegBlock;case"FlowGraphSinBlock":return async()=>(await a(async()=>{const{FlowGraphSinBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphSinBlock:t}},[])).FlowGraphSinBlock;case"FlowGraphCosBlock":return async()=>(await a(async()=>{const{FlowGraphCosBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphCosBlock:t}},[])).FlowGraphCosBlock;case"FlowGraphTanBlock":return async()=>(await a(async()=>{const{FlowGraphTanBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphTanBlock:t}},[])).FlowGraphTanBlock;case"FlowGraphASinBlock":return async()=>(await a(async()=>{const{FlowGraphAsinBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphAsinBlock:t}},[])).FlowGraphAsinBlock;case"FlowGraphACosBlock":return async()=>(await a(async()=>{const{FlowGraphAcosBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphAcosBlock:t}},[])).FlowGraphAcosBlock;case"FlowGraphATanBlock":return async()=>(await a(async()=>{const{FlowGraphAtanBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphAtanBlock:t}},[])).FlowGraphAtanBlock;case"FlowGraphATan2Block":return async()=>(await a(async()=>{const{FlowGraphAtan2Block:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphAtan2Block:t}},[])).FlowGraphAtan2Block;case"FlowGraphSinhBlock":return async()=>(await a(async()=>{const{FlowGraphSinhBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphSinhBlock:t}},[])).FlowGraphSinhBlock;case"FlowGraphCoshBlock":return async()=>(await a(async()=>{const{FlowGraphCoshBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphCoshBlock:t}},[])).FlowGraphCoshBlock;case"FlowGraphTanhBlock":return async()=>(await a(async()=>{const{FlowGraphTanhBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphTanhBlock:t}},[])).FlowGraphTanhBlock;case"FlowGraphASinhBlock":return async()=>(await a(async()=>{const{FlowGraphAsinhBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphAsinhBlock:t}},[])).FlowGraphAsinhBlock;case"FlowGraphACoshBlock":return async()=>(await a(async()=>{const{FlowGraphAcoshBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphAcoshBlock:t}},[])).FlowGraphAcoshBlock;case"FlowGraphATanhBlock":return async()=>(await a(async()=>{const{FlowGraphAtanhBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphAtanhBlock:t}},[])).FlowGraphAtanhBlock;case"FlowGraphExponentialBlock":return async()=>(await a(async()=>{const{FlowGraphExpBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphExpBlock:t}},[])).FlowGraphExpBlock;case"FlowGraphLogBlock":return async()=>(await a(async()=>{const{FlowGraphLogBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphLogBlock:t}},[])).FlowGraphLogBlock;case"FlowGraphLog2Block":return async()=>(await a(async()=>{const{FlowGraphLog2Block:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphLog2Block:t}},[])).FlowGraphLog2Block;case"FlowGraphLog10Block":return async()=>(await a(async()=>{const{FlowGraphLog10Block:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphLog10Block:t}},[])).FlowGraphLog10Block;case"FlowGraphSquareRootBlock":return async()=>(await a(async()=>{const{FlowGraphSquareRootBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphSquareRootBlock:t}},[])).FlowGraphSquareRootBlock;case"FlowGraphPowerBlock":return async()=>(await a(async()=>{const{FlowGraphPowerBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphPowerBlock:t}},[])).FlowGraphPowerBlock;case"FlowGraphCubeRootBlock":return async()=>(await a(async()=>{const{FlowGraphCubeRootBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphCubeRootBlock:t}},[])).FlowGraphCubeRootBlock;case"FlowGraphBitwiseAndBlock":return async()=>(await a(async()=>{const{FlowGraphBitwiseAndBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphBitwiseAndBlock:t}},[])).FlowGraphBitwiseAndBlock;case"FlowGraphBitwiseOrBlock":return async()=>(await a(async()=>{const{FlowGraphBitwiseOrBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphBitwiseOrBlock:t}},[])).FlowGraphBitwiseOrBlock;case"FlowGraphBitwiseNotBlock":return async()=>(await a(async()=>{const{FlowGraphBitwiseNotBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphBitwiseNotBlock:t}},[])).FlowGraphBitwiseNotBlock;case"FlowGraphBitwiseXorBlock":return async()=>(await a(async()=>{const{FlowGraphBitwiseXorBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphBitwiseXorBlock:t}},[])).FlowGraphBitwiseXorBlock;case"FlowGraphBitwiseLeftShiftBlock":return async()=>(await a(async()=>{const{FlowGraphBitwiseLeftShiftBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphBitwiseLeftShiftBlock:t}},[])).FlowGraphBitwiseLeftShiftBlock;case"FlowGraphBitwiseRightShiftBlock":return async()=>(await a(async()=>{const{FlowGraphBitwiseRightShiftBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphBitwiseRightShiftBlock:t}},[])).FlowGraphBitwiseRightShiftBlock;case"FlowGraphLengthBlock":return async()=>(await a(async()=>{const{FlowGraphLengthBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c3);return{FlowGraphLengthBlock:t}},[])).FlowGraphLengthBlock;case"FlowGraphNormalizeBlock":return async()=>(await a(async()=>{const{FlowGraphNormalizeBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c3);return{FlowGraphNormalizeBlock:t}},[])).FlowGraphNormalizeBlock;case"FlowGraphDotBlock":return async()=>(await a(async()=>{const{FlowGraphDotBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c3);return{FlowGraphDotBlock:t}},[])).FlowGraphDotBlock;case"FlowGraphCrossBlock":return async()=>(await a(async()=>{const{FlowGraphCrossBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c3);return{FlowGraphCrossBlock:t}},[])).FlowGraphCrossBlock;case"FlowGraphRotate2DBlock":return async()=>(await a(async()=>{const{FlowGraphRotate2DBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c3);return{FlowGraphRotate2DBlock:t}},[])).FlowGraphRotate2DBlock;case"FlowGraphRotate3DBlock":return async()=>(await a(async()=>{const{FlowGraphRotate3DBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c3);return{FlowGraphRotate3DBlock:t}},[])).FlowGraphRotate3DBlock;case"FlowGraphTransposeBlock":return async()=>(await a(async()=>{const{FlowGraphTransposeBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c2);return{FlowGraphTransposeBlock:t}},[])).FlowGraphTransposeBlock;case"FlowGraphDeterminantBlock":return async()=>(await a(async()=>{const{FlowGraphDeterminantBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c2);return{FlowGraphDeterminantBlock:t}},[])).FlowGraphDeterminantBlock;case"FlowGraphInvertMatrixBlock":return async()=>(await a(async()=>{const{FlowGraphInvertMatrixBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c2);return{FlowGraphInvertMatrixBlock:t}},[])).FlowGraphInvertMatrixBlock;case"FlowGraphMatrixMultiplicationBlock":return async()=>(await a(async()=>{const{FlowGraphMatrixMultiplicationBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c2);return{FlowGraphMatrixMultiplicationBlock:t}},[])).FlowGraphMatrixMultiplicationBlock;case"FlowGraphBranchBlock":return async()=>(await a(async()=>{const{FlowGraphBranchBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bz);return{FlowGraphBranchBlock:t}},[])).FlowGraphBranchBlock;case"FlowGraphSetDelayBlock":return async()=>(await a(async()=>{const{FlowGraphSetDelayBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bL);return{FlowGraphSetDelayBlock:t}},[])).FlowGraphSetDelayBlock;case"FlowGraphCancelDelayBlock":return async()=>(await a(async()=>{const{FlowGraphCancelDelayBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bM);return{FlowGraphCancelDelayBlock:t}},[])).FlowGraphCancelDelayBlock;case"FlowGraphCallCounterBlock":return async()=>(await a(async()=>{const{FlowGraphCallCounterBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bG);return{FlowGraphCallCounterBlock:t}},[])).FlowGraphCallCounterBlock;case"FlowGraphDebounceBlock":return async()=>(await a(async()=>{const{FlowGraphDebounceBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bI);return{FlowGraphDebounceBlock:t}},[])).FlowGraphDebounceBlock;case"FlowGraphThrottleBlock":return async()=>(await a(async()=>{const{FlowGraphThrottleBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bC);return{FlowGraphThrottleBlock:t}},[])).FlowGraphThrottleBlock;case"FlowGraphDoNBlock":return async()=>(await a(async()=>{const{FlowGraphDoNBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bA);return{FlowGraphDoNBlock:t}},[])).FlowGraphDoNBlock;case"FlowGraphFlipFlopBlock":return async()=>(await a(async()=>{const{FlowGraphFlipFlopBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bJ);return{FlowGraphFlipFlopBlock:t}},[])).FlowGraphFlipFlopBlock;case"FlowGraphForLoopBlock":return async()=>(await a(async()=>{const{FlowGraphForLoopBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bB);return{FlowGraphForLoopBlock:t}},[])).FlowGraphForLoopBlock;case"FlowGraphMultiGateBlock":return async()=>(await a(async()=>{const{FlowGraphMultiGateBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bD);return{FlowGraphMultiGateBlock:t}},[])).FlowGraphMultiGateBlock;case"FlowGraphSequenceBlock":return async()=>(await a(async()=>{const{FlowGraphSequenceBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bK);return{FlowGraphSequenceBlock:t}},[])).FlowGraphSequenceBlock;case"FlowGraphSwitchBlock":return async()=>(await a(async()=>{const{FlowGraphSwitchBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bE);return{FlowGraphSwitchBlock:t}},[])).FlowGraphSwitchBlock;case"FlowGraphWaitAllBlock":return async()=>(await a(async()=>{const{FlowGraphWaitAllBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bF);return{FlowGraphWaitAllBlock:t}},[])).FlowGraphWaitAllBlock;case"FlowGraphWhileLoopBlock":return async()=>(await a(async()=>{const{FlowGraphWhileLoopBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bH);return{FlowGraphWhileLoopBlock:t}},[])).FlowGraphWhileLoopBlock;case"FlowGraphConsoleLogBlock":return async()=>(await a(async()=>{const{FlowGraphConsoleLogBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.by);return{FlowGraphConsoleLogBlock:t}},[])).FlowGraphConsoleLogBlock;case"FlowGraphConditionalBlock":return async()=>(await a(async()=>{const{FlowGraphConditionalDataBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bT);return{FlowGraphConditionalDataBlock:t}},[])).FlowGraphConditionalDataBlock;case"FlowGraphConstantBlock":return async()=>(await a(async()=>{const{FlowGraphConstantBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bZ);return{FlowGraphConstantBlock:t}},[])).FlowGraphConstantBlock;case"FlowGraphTransformCoordinatesSystemBlock":return async()=>(await a(async()=>{const{FlowGraphTransformCoordinatesSystemBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bW);return{FlowGraphTransformCoordinatesSystemBlock:t}},[])).FlowGraphTransformCoordinatesSystemBlock;case"FlowGraphGetAssetBlock":return async()=>(await a(async()=>{const{FlowGraphGetAssetBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.b_);return{FlowGraphGetAssetBlock:t}},[])).FlowGraphGetAssetBlock;case"FlowGraphGetPropertyBlock":return async()=>(await a(async()=>{const{FlowGraphGetPropertyBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bX);return{FlowGraphGetPropertyBlock:t}},[])).FlowGraphGetPropertyBlock;case"FlowGraphSetPropertyBlock":return async()=>(await a(async()=>{const{FlowGraphSetPropertyBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bY);return{FlowGraphSetPropertyBlock:t}},[])).FlowGraphSetPropertyBlock;case"FlowGraphGetVariableBlock":return async()=>(await a(async()=>{const{FlowGraphGetVariableBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bU);return{FlowGraphGetVariableBlock:t}},[])).FlowGraphGetVariableBlock;case"FlowGraphSetVariableBlock":return async()=>(await a(async()=>{const{FlowGraphSetVariableBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bV);return{FlowGraphSetVariableBlock:t}},[])).FlowGraphSetVariableBlock;case"FlowGraphJsonPointerParserBlock":return async()=>(await a(async()=>{const{FlowGraphJsonPointerParserBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c4);return{FlowGraphJsonPointerParserBlock:t}},[])).FlowGraphJsonPointerParserBlock;case"FlowGraphLeadingZerosBlock":return async()=>(await a(async()=>{const{FlowGraphLeadingZerosBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphLeadingZerosBlock:t}},[])).FlowGraphLeadingZerosBlock;case"FlowGraphTrailingZerosBlock":return async()=>(await a(async()=>{const{FlowGraphTrailingZerosBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphTrailingZerosBlock:t}},[])).FlowGraphTrailingZerosBlock;case"FlowGraphOneBitsCounterBlock":return async()=>(await a(async()=>{const{FlowGraphOneBitsCounterBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c0);return{FlowGraphOneBitsCounterBlock:t}},[])).FlowGraphOneBitsCounterBlock;case"FlowGraphCombineVector2Block":return async()=>(await a(async()=>{const{FlowGraphCombineVector2Block:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c1);return{FlowGraphCombineVector2Block:t}},[])).FlowGraphCombineVector2Block;case"FlowGraphCombineVector3Block":return async()=>(await a(async()=>{const{FlowGraphCombineVector3Block:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c1);return{FlowGraphCombineVector3Block:t}},[])).FlowGraphCombineVector3Block;case"FlowGraphCombineVector4Block":return async()=>(await a(async()=>{const{FlowGraphCombineVector4Block:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c1);return{FlowGraphCombineVector4Block:t}},[])).FlowGraphCombineVector4Block;case"FlowGraphCombineMatrixBlock":return async()=>(await a(async()=>{const{FlowGraphCombineMatrixBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c1);return{FlowGraphCombineMatrixBlock:t}},[])).FlowGraphCombineMatrixBlock;case"FlowGraphExtractVector2Block":return async()=>(await a(async()=>{const{FlowGraphExtractVector2Block:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c1);return{FlowGraphExtractVector2Block:t}},[])).FlowGraphExtractVector2Block;case"FlowGraphExtractVector3Block":return async()=>(await a(async()=>{const{FlowGraphExtractVector3Block:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c1);return{FlowGraphExtractVector3Block:t}},[])).FlowGraphExtractVector3Block;case"FlowGraphExtractVector4Block":return async()=>(await a(async()=>{const{FlowGraphExtractVector4Block:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c1);return{FlowGraphExtractVector4Block:t}},[])).FlowGraphExtractVector4Block;case"FlowGraphExtractMatrixBlock":return async()=>(await a(async()=>{const{FlowGraphExtractMatrixBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c1);return{FlowGraphExtractMatrixBlock:t}},[])).FlowGraphExtractMatrixBlock;case"FlowGraphTransformVectorBlock":return async()=>(await a(async()=>{const{FlowGraphTransformBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c3);return{FlowGraphTransformBlock:t}},[])).FlowGraphTransformBlock;case"FlowGraphTransformCoordinatesBlock":return async()=>(await a(async()=>{const{FlowGraphTransformCoordinatesBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c3);return{FlowGraphTransformCoordinatesBlock:t}},[])).FlowGraphTransformCoordinatesBlock;case"FlowGraphMatrixDecompose":return async()=>(await a(async()=>{const{FlowGraphMatrixDecomposeBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c2);return{FlowGraphMatrixDecomposeBlock:t}},[])).FlowGraphMatrixDecomposeBlock;case"FlowGraphMatrixCompose":return async()=>(await a(async()=>{const{FlowGraphMatrixComposeBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c2);return{FlowGraphMatrixComposeBlock:t}},[])).FlowGraphMatrixComposeBlock;case"FlowGraphBooleanToFloat":return async()=>(await a(async()=>{const{FlowGraphBooleanToFloat:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c5);return{FlowGraphBooleanToFloat:t}},[])).FlowGraphBooleanToFloat;case"FlowGraphBooleanToInt":return async()=>(await a(async()=>{const{FlowGraphBooleanToInt:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c5);return{FlowGraphBooleanToInt:t}},[])).FlowGraphBooleanToInt;case"FlowGraphFloatToBoolean":return async()=>(await a(async()=>{const{FlowGraphFloatToBoolean:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c5);return{FlowGraphFloatToBoolean:t}},[])).FlowGraphFloatToBoolean;case"FlowGraphIntToBoolean":return async()=>(await a(async()=>{const{FlowGraphIntToBoolean:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c5);return{FlowGraphIntToBoolean:t}},[])).FlowGraphIntToBoolean;case"FlowGraphIntToFloat":return async()=>(await a(async()=>{const{FlowGraphIntToFloat:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c5);return{FlowGraphIntToFloat:t}},[])).FlowGraphIntToFloat;case"FlowGraphFloatToInt":return async()=>(await a(async()=>{const{FlowGraphFloatToInt:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c5);return{FlowGraphFloatToInt:t}},[])).FlowGraphFloatToInt;case"FlowGraphEasingBlock":return async()=>(await a(async()=>{const{FlowGraphEasingBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bR);return{FlowGraphEasingBlock:t}},[])).FlowGraphEasingBlock;case"FlowGraphBezierCurveEasing":return async()=>(await a(async()=>{const{FlowGraphBezierCurveEasingBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.bS);return{FlowGraphBezierCurveEasingBlock:t}},[])).FlowGraphBezierCurveEasingBlock;case"FlowGraphPointerOverEventBlock":return async()=>(await a(async()=>{const{FlowGraphPointerOverEventBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.cg);return{FlowGraphPointerOverEventBlock:t}},[])).FlowGraphPointerOverEventBlock;case"FlowGraphPointerOutEventBlock":return async()=>(await a(async()=>{const{FlowGraphPointerOutEventBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.cf);return{FlowGraphPointerOutEventBlock:t}},[])).FlowGraphPointerOutEventBlock;case"FlowGraphContextBlock":return async()=>(await a(async()=>{const{FlowGraphContextBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c6);return{FlowGraphContextBlock:t}},[])).FlowGraphContextBlock;case"FlowGraphArrayIndexBlock":return async()=>(await a(async()=>{const{FlowGraphArrayIndexBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c7);return{FlowGraphArrayIndexBlock:t}},[])).FlowGraphArrayIndexBlock;case"FlowGraphCodeExecutionBlock":return async()=>(await a(async()=>{const{FlowGraphCodeExecutionBlock:t}=await import("./flowGraphCodeExecutionBlock-rGFMQEYc.js");return{FlowGraphCodeExecutionBlock:t}},__vite__mapDeps([0,1]))).FlowGraphCodeExecutionBlock;case"FlowGraphIndexOfBlock":return async()=>(await a(async()=>{const{FlowGraphIndexOfBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c8);return{FlowGraphIndexOfBlock:t}},[])).FlowGraphIndexOfBlock;case"FlowGraphFunctionReference":return async()=>(await a(async()=>{const{FlowGraphFunctionReferenceBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.c9);return{FlowGraphFunctionReferenceBlock:t}},[])).FlowGraphFunctionReferenceBlock;case"FlowGraphDataSwitchBlock":return async()=>(await a(async()=>{const{FlowGraphDataSwitchBlock:t}=await import("./sceneFragmentDeclaration-CNWtVIbJ.js").then(o=>o.b$);return{FlowGraphDataSwitchBlock:t}},[])).FlowGraphDataSwitchBlock;default:if(Z[e])return Z[e];throw new Error(`Unknown block name ${e}`)}}function ht(e,t){for(const o of e)for(const r of o.dataOutputs)if(r.uniqueId===t)return r;throw new Error("Could not find data out connection with unique id "+t)}function wt(e,t){for(const o of e)if(o instanceof j){for(const r of o.signalInputs)if(r.uniqueId===t)return r}throw new Error("Could not find signal in connection with unique id "+t)}async function _t(e,t){const o=await Promise.all(e.allBlocks.map(async r=>ut(r.className)()));return Gt(e,t,o)}function Gt(e,t,o){const r=t.coordinator.createGraph(),n=[],i=t.valueParseFunction??U;for(let c=0;c<e.allBlocks.length;c++){const s=e.allBlocks[c],u=Ft(s,{scene:t.coordinator.config.scene,pathConverter:t.pathConverter,assetsContainer:t.coordinator.config.scene,valueParseFunction:i},o[c]);n.push(u),u instanceof at&&r.addEventBlock(u)}for(const c of n){for(const s of c.dataInputs)for(const u of s.connectedPointIds){const h=ht(n,u);s.connectTo(h)}if(c instanceof j)for(const s of c.signalOutputs)for(const u of s.connectedPointIds){const h=wt(n,u);s.connectTo(h)}}for(const c of e.executionContexts)kt(c,{graph:r,valueParseFunction:i},e.rightHanded);return r}function kt(e,t,o){var c,s,u,h,l,w,L,f,b,C;const r=t.graph.createContext();e.enableLogging&&(r.enableLogging=!0),r.treatDataAsRightHanded=o||!1;const n=t.valueParseFunction??U;r.uniqueId=e.uniqueId;const i=r.getScene();if(e._assetsContext){const _=e._assetsContext,T={meshes:(c=_.meshes)==null?void 0:c.map(p=>i.getMeshById(p)),lights:(s=_.lights)==null?void 0:s.map(p=>i.getLightByName(p)),cameras:(u=_.cameras)==null?void 0:u.map(p=>i.getCameraByName(p)),materials:(h=_.materials)==null?void 0:h.map(p=>i.getMaterialById(p)),textures:(l=_.textures)==null?void 0:l.map(p=>i.getTextureByName(p)),animations:(w=_.animations)==null?void 0:w.map(p=>i.animations.find(W=>W.name===p)),skeletons:(L=_.skeletons)==null?void 0:L.map(p=>i.getSkeletonByName(p)),particleSystems:(f=_.particleSystems)==null?void 0:f.map(p=>i.getParticleSystemById(p)),animationGroups:(b=_.animationGroups)==null?void 0:b.map(p=>i.getAnimationGroupByName(p)),transformNodes:(C=_.transformNodes)==null?void 0:C.map(p=>i.getTransformNodeById(p)),rootNodes:[],multiMaterials:[],morphTargetManagers:[],geometries:[],actionManagers:[],environmentTexture:null,postProcesses:[],sounds:null,effectLayers:[],layers:[],reflectionProbes:[],lensFlareSystems:[],proceduralTextures:[],getNodes:function(){throw new Error("Function not implemented.")}};r.assetsContext=T}for(const _ in e._userVariables){const T=n(_,e._userVariables,r.assetsContext,i);r.userVariables[_]=T}for(const _ in e._connectionValues){const T=n(_,e._connectionValues,r.assetsContext,i);r._setConnectionValueByKey(_,T)}return r}function Ft(e,t,o){const r={},n=t.valueParseFunction??U;if(e.config)for(const c in e.config)r[c]=n(c,e.config,t.assetsContainer||t.scene,t.scene);if(rt(e.className)){if(!t.pathConverter)throw new Error("Path converter is required for this block");r.pathConverter=t.pathConverter}const i=new o(r);i.uniqueId=e.uniqueId;for(let c=0;c<e.dataInputs.length;c++){const s=i.getDataInput(e.dataInputs[c].name);if(s)s.deserialize(e.dataInputs[c]);else throw new Error("Could not find data input with name "+e.dataInputs[c].name+" in block "+e.className)}for(let c=0;c<e.dataOutputs.length;c++){const s=i.getDataOutput(e.dataOutputs[c].name);if(s)s.deserialize(e.dataOutputs[c]);else throw new Error("Could not find data output with name "+e.dataOutputs[c].name+" in block "+e.className)}return i.metadata=e.metadata,i.deserialize&&i.deserialize(e),i}const dt={float:{length:1,flowGraphType:"number",elementType:"number"},bool:{length:1,flowGraphType:"boolean",elementType:"boolean"},float2:{length:2,flowGraphType:"Vector2",elementType:"number"},float3:{length:3,flowGraphType:"Vector3",elementType:"number"},float4:{length:4,flowGraphType:"Vector4",elementType:"number"},float4x4:{length:16,flowGraphType:"Matrix",elementType:"number"},float2x2:{length:4,flowGraphType:"Matrix2D",elementType:"number"},float3x3:{length:9,flowGraphType:"Matrix3D",elementType:"number"},int:{length:1,flowGraphType:"FlowGraphInteger",elementType:"number"}};class yt{constructor(t,o,r){this._interactivityGraph=t,this._gltf=o,this._loader=r,this._types=[],this._mappings=[],this._staticVariables=[],this._events=[],this._internalEventsCounter=0,this._nodes=[],this._parseTypes(),this._parseDeclarations(),this._parseVariables(),this._parseEvents(),this._parseNodes()}get arrays(){return{types:this._types,mappings:this._mappings,staticVariables:this._staticVariables,events:this._events,nodes:this._nodes}}_parseTypes(){if(this._interactivityGraph.types)for(const t of this._interactivityGraph.types)this._types.push(dt[t.signature])}_parseDeclarations(){if(this._interactivityGraph.declarations)for(const t of this._interactivityGraph.declarations){const o=lt(t);if(!o)throw F.Error(["No mapping found for declaration",t]),new Error("Error parsing declarations");this._mappings.push({flowGraphMapping:o,fullOperationName:t.extension?t.op+":"+t.extension:t.op})}}_parseVariables(){if(this._interactivityGraph.variables)for(const t of this._interactivityGraph.variables){const o=this._parseVariable(t);this._staticVariables.push(o)}}_parseVariable(t,o){const r=this._types[t.type];if(!r)throw F.Error(["No type found for variable",t]),new Error("Error parsing variables");if(t.value&&t.value.length!==r.length)throw F.Error(["Invalid value length for variable",t,r]),new Error("Error parsing variables");const n=t.value||[];if(!n.length)switch(r.flowGraphType){case"boolean":n.push(!1);break;case"FlowGraphInteger":n.push(0);break;case"number":n.push(NaN);break;case"Vector2":n.push(NaN,NaN);break;case"Vector3":n.push(NaN,NaN,NaN);break;case"Vector4":case"Matrix2D":case"Quaternion":n.fill(NaN,0,4);break;case"Matrix":n.fill(NaN,0,16);break;case"Matrix3D":n.fill(NaN,0,9);break}return r.elementType==="number"&&typeof n[0]=="string"&&(n[0]=parseFloat(n[0])),{type:r.flowGraphType,value:o?o(n,this):n}}_parseEvents(){if(this._interactivityGraph.events)for(const t of this._interactivityGraph.events){const o={eventId:t.id||"internalEvent_"+this._internalEventsCounter++};t.values&&(o.eventData=Object.keys(t.values).map(r=>{var s;const n=(s=t.values)==null?void 0:s[r];if(!n)throw F.Error(["No value found for event key",r]),new Error("Error parsing events");const i=this._types[n.type];if(!i)throw F.Error(["No type found for event value",n]),new Error("Error parsing events");const c=typeof n.value<"u"?this._parseVariable(n):void 0;return{id:r,type:i.flowGraphType,eventData:!0,value:c}})),this._events.push(o)}}_parseNodes(){var t;if(this._interactivityGraph.nodes)for(const o of this._interactivityGraph.nodes){if(typeof o.declaration!="number")throw F.Error(["No declaration found for node",o]),new Error("Error parsing nodes");const r=this._mappings[o.declaration];if(!r)throw F.Error(["No mapping found for node",o]),new Error("Error parsing nodes");if(r.flowGraphMapping.validation){const i=r.flowGraphMapping.validation(o,this._interactivityGraph,this._gltf);if(!i.valid)throw new Error(`Error validating interactivity node ${(t=this._interactivityGraph.declarations)==null?void 0:t[o.declaration].op} - ${i.error}`)}const n=[];for(const i of r.flowGraphMapping.blocks){const c=this._getEmptyBlock(i,r.fullOperationName);this._parseNodeConfiguration(o,c,r.flowGraphMapping,i),n.push(c)}this._nodes.push({blocks:n,fullOperationName:r.fullOperationName})}}_getEmptyBlock(t,o){return{uniqueId:$(),className:t,dataInputs:[],dataOutputs:[],signalInputs:[],signalOutputs:[],config:{},type:o,metadata:{}}}_parseNodeConfiguration(t,o,r,n){var c,s;const i=o.config;if(t.configuration){const u=Object.keys(t.configuration);for(const h of u){const l=(c=t.configuration)==null?void 0:c[h];if(!l)throw F.Error(["No value found for node configuration",h]),new Error("Error parsing node configuration");const w=(s=r.configuration)==null?void 0:s[h];if(w&&w.toBlock?w.toBlock===n:r.blocks.indexOf(n)===0){const f=(w==null?void 0:w.name)||h;(!l||typeof l.value>"u")&&typeof(w==null?void 0:w.defaultValue)<"u"?i[f]={value:w.defaultValue}:l.value.length>=1?i[f]={value:l.value.length===1?l.value[0]:l.value}:F.Warn(["Invalid value for node configuration",l]),w&&w.dataTransformer&&(i[f].value=w.dataTransformer([i[f].value],this)[0])}}}}_parseNodeConnections(t){var o,r,n,i,c,s,u,h,l,w,L,f,b,C,_,T,p,W,J;for(let N=0;N<this._nodes.length;N++){const I=(o=this._interactivityGraph.nodes)==null?void 0:o[N];if(!I)throw F.Error(["No node found for interactivity node",this._nodes[N]]),new Error("Error parsing node connections");const g=this._nodes[N],v=this._mappings[I.declaration];if(!v)throw F.Error(["No mapping found for node",I]),new Error("Error parsing node connections");const Q=I.flows||{},tt=Object.keys(Q).sort();for(const k of tt){const d=Q[k],G=(n=(r=v.flowGraphMapping.outputs)==null?void 0:r.flows)==null?void 0:n[k],O=(G==null?void 0:G.name)||k,x=this._createNewSocketConnection(O,!0);(G&&G.toBlock&&g.blocks.find(m=>m.className===G.toBlock)||g.blocks[0]).signalOutputs.push(x);const H=d.node,y=this._nodes[H];if(!y)throw F.Error(["No node found for input node id",H]),new Error("Error parsing node connections");const P=z(y.fullOperationName);if(!P)throw F.Error(["No mapping found for input node",y]),new Error("Error parsing node connections");let B=(c=(i=P.inputs)==null?void 0:i.flows)==null?void 0:c[d.socket||"in"],V=!1;if(!B)for(const m in(s=P.inputs)==null?void 0:s.flows)m.startsWith("[")&&m.endsWith("]")&&(V=!0,B=(h=(u=P.inputs)==null?void 0:u.flows)==null?void 0:h[m]);const E=B?V?B.name.replace("$1",d.socket||""):B.name:d.socket||"in",M=B&&B.toBlock&&y.blocks.find(m=>m.className===B.toBlock)||y.blocks[0];let A=M.signalInputs.find(m=>m.name===E);A||(A=this._createNewSocketConnection(E),M.signalInputs.push(A)),A.connectedPointIds.push(x.uniqueId),x.connectedPointIds.push(A.uniqueId)}const X=I.values||{},ot=Object.keys(X);for(const k of ot){const d=X[k];let G=(w=(l=v.flowGraphMapping.inputs)==null?void 0:l.values)==null?void 0:w[k],O=!1;if(!G)for(const y in(L=v.flowGraphMapping.inputs)==null?void 0:L.values)y.startsWith("[")&&y.endsWith("]")&&(O=!0,G=(b=(f=v.flowGraphMapping.inputs)==null?void 0:f.values)==null?void 0:b[y]);const x=G?O?G.name.replace("$1",k):G.name:k,S=this._createNewSocketConnection(x);if((G&&G.toBlock&&g.blocks.find(y=>y.className===G.toBlock)||g.blocks[0]).dataInputs.push(S),d.value!==void 0){const y=this._parseVariable(d,G&&G.dataTransformer);t._connectionValues[S.uniqueId]=y}else if(typeof d.node<"u"){const y=d.node,P=d.socket||"value",B=this._nodes[y];if(!B)throw F.Error(["No node found for output socket reference",d]),new Error("Error parsing node connections");const V=z(B.fullOperationName);if(!V)throw F.Error(["No mapping found for output socket reference",d]),new Error("Error parsing node connections");let E=(_=(C=V.outputs)==null?void 0:C.values)==null?void 0:_[P],M=!1;if(!E)for(const D in(T=V.outputs)==null?void 0:T.values)D.startsWith("[")&&D.endsWith("]")&&(M=!0,E=(W=(p=V.outputs)==null?void 0:p.values)==null?void 0:W[D]);const A=E?M?E.name.replace("$1",P):E==null?void 0:E.name:P,m=E&&E.toBlock&&B.blocks.find(D=>D.className===E.toBlock)||B.blocks[0];let q=m.dataOutputs.find(D=>D.name===A);q||(q=this._createNewSocketConnection(A,!0),m.dataOutputs.push(q)),S.connectedPointIds.push(q.uniqueId),q.connectedPointIds.push(S.uniqueId)}else throw F.Error(["Invalid value for value connection",d]),new Error("Error parsing node connections")}if(v.flowGraphMapping.interBlockConnectors)for(const k of v.flowGraphMapping.interBlockConnectors){const d=k.input,G=k.output,O=k.isVariable;this._connectFlowGraphNodes(d,G,g.blocks[k.inputBlockIndex],g.blocks[k.outputBlockIndex],O)}if(v.flowGraphMapping.extraProcessor){const k=(J=this._interactivityGraph.declarations)==null?void 0:J[I.declaration];if(!k)throw F.Error(["No declaration found for extra processor",I]),new Error("Error parsing node connections");g.blocks=v.flowGraphMapping.extraProcessor(I,k,v.flowGraphMapping,this,g.blocks,t,this._gltf)}}}_createNewSocketConnection(t,o){return{uniqueId:$(),name:t,_connectionType:o?1:0,connectedPointIds:[]}}_connectFlowGraphNodes(t,o,r,n,i){const c=i?r.dataInputs:r.signalInputs,s=i?n.dataOutputs:n.signalOutputs,u=c.find(l=>l.name===t)||this._createNewSocketConnection(t),h=s.find(l=>l.name===o)||this._createNewSocketConnection(o,!0);c.find(l=>l.name===t)||c.push(u),s.find(l=>l.name===o)||s.push(h),u.connectedPointIds.push(h.uniqueId),h.connectedPointIds.push(u.uniqueId)}getVariableName(t){return"staticVariable_"+t}serializeToFlowGraph(){const t={uniqueId:$(),_userVariables:{},_connectionValues:{}};this._parseNodeConnections(t);for(let r=0;r<this._staticVariables.length;r++){const n=this._staticVariables[r];t._userVariables[this.getVariableName(r)]=n}return{rightHanded:!0,allBlocks:this._nodes.reduce((r,n)=>r.concat(n.blocks),[]),executionContexts:[t]}}}const K="KHR_interactivity";class Bt{constructor(t){this._loader=t,this.name=K,this.enabled=this._loader.isExtensionUsed(K),this._pathConverter=st(this._loader.gltf),t._skipStartAnimationStep=!0;const o=t.babylonScene;o&&Et(o)}dispose(){this._loader=null,delete this._pathConverter}async onReady(){var i;if(!this._loader.babylonScene||!this._pathConverter)return;const t=this._loader.babylonScene,o=(i=this._loader.gltf.extensions)==null?void 0:i.KHR_interactivity;if(!o)return;const r=new et({scene:t});r.dispatchEventsSynchronously=!1;const n=o.graphs.map(c=>new yt(c,this._loader.gltf,this._loader).serializeToFlowGraph());await Promise.all(n.map(c=>_t(c,{coordinator:r,pathConverter:this._pathConverter}))),r.start()}}function Et(e){R("/extensions/KHR_interactivity/?/activeCamera/rotation",{get:()=>e.activeCamera?Y.FromRotationMatrix(e.activeCamera.getWorldMatrix()).normalize():new Y(NaN,NaN,NaN,NaN),type:"Quaternion",getTarget:()=>e.activeCamera}),R("/extensions/KHR_interactivity/?/activeCamera/position",{get:()=>e.activeCamera?e.activeCamera.position:new nt(NaN,NaN,NaN),type:"Vector3",getTarget:()=>e.activeCamera}),R("/animations/{}/extensions/KHR_interactivity/isPlaying",{get:t=>{var o;return((o=t._babylonAnimationGroup)==null?void 0:o.isPlaying)??!1},type:"boolean",getTarget:t=>t._babylonAnimationGroup}),R("/animations/{}/extensions/KHR_interactivity/minTime",{get:t=>{var o;return(((o=t._babylonAnimationGroup)==null?void 0:o.from)??0)/60},type:"number",getTarget:t=>t._babylonAnimationGroup}),R("/animations/{}/extensions/KHR_interactivity/maxTime",{get:t=>{var o;return(((o=t._babylonAnimationGroup)==null?void 0:o.to)??0)/60},type:"number",getTarget:t=>t._babylonAnimationGroup}),R("/animations/{}/extensions/KHR_interactivity/playhead",{get:t=>{var o;return(((o=t._babylonAnimationGroup)==null?void 0:o.getCurrentFrame())??0)/60},type:"number",getTarget:t=>t._babylonAnimationGroup}),R("/animations/{}/extensions/KHR_interactivity/virtualPlayhead",{get:t=>{var o;return(((o=t._babylonAnimationGroup)==null?void 0:o.getCurrentFrame())??0)/60},type:"number",getTarget:t=>t._babylonAnimationGroup})}pt(K,"FlowGraphGLTFDataProvider",async()=>(await a(async()=>{const{FlowGraphGLTFDataProvider:e}=await import("./flowGraphGLTFDataProvider-_4JvEaCu.js");return{FlowGraphGLTFDataProvider:e}},__vite__mapDeps([2,1]))).FlowGraphGLTFDataProvider);ct(K);it(K,!0,e=>new Bt(e));export{Bt as KHR_interactivity,Et as _AddInteractivityObjectModel};
