import{u as _,r as h}from"./model-viewer-CRf71ZHW.js";import{b as x}from"./declarationMapper-BB1D8Xqx.js";import{A as y}from"./objectModelMapping-DZbRXB0J.js";import"./with-props-CdbLO-WJ.js";import"./chunk-AYJ5UCUI-B1579ApN.js";import"./sceneFragmentDeclaration-CNWtVIbJ.js";import"./waterMaterial-DHEJP-Do.js";const s="KHR_node_selectability";x("event/onSelect",s,{blocks:["FlowGraphMeshPickEventBlock","FlowGraphGetVariableBlock","FlowGraphIndexOfBlock","KHR_interactivity/FlowGraphGLTFDataProvider"],configuration:{stopPropagation:{name:"stopPropagation"},nodeIndex:{name:"variable",toBlock:"FlowGraphGetVariableBlock",dataTransformer(e){return["pickedMesh_"+e[0]]}}},outputs:{values:{selectedNodeIndex:{name:"index",toBlock:"FlowGraphIndexOfBlock"},controllerIndex:{name:"pointerId"},selectionPoint:{name:"pickedPoint"},selectionRayOrigin:{name:"pickOrigin"}},flows:{out:{name:"done"}}},interBlockConnectors:[{input:"asset",output:"value",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"array",output:"nodes",inputBlockIndex:2,outputBlockIndex:3,isVariable:!0},{input:"object",output:"pickedMesh",inputBlockIndex:2,outputBlockIndex:0,isVariable:!0}],extraProcessor(e,n,t,r,i,c,o){var u,p,f,m,b,k;const d=i[i.length-1];d.config=d.config||{},d.config.glTF=o;const a=(p=(u=e.configuration)==null?void 0:u.nodeIndex)==null?void 0:p.value[0];if(a===void 0||typeof a!="number")throw new Error("nodeIndex not found in configuration");const l="pickedMesh_"+a;return i[1].config.variable=l,c._userVariables[l]={className:"Mesh",id:(m=(f=o==null?void 0:o.nodes)==null?void 0:f[a]._babylonTransformNode)==null?void 0:m.id,uniqueId:(k=(b=o==null?void 0:o.nodes)==null?void 0:b[a]._babylonTransformNode)==null?void 0:k.uniqueId},i}});y("/nodes/{}/extensions/KHR_node_selectability/selectable",{get:e=>{const n=e._babylonTransformNode;return n&&n.isPickable!==void 0?n.isPickable:!0},set:(e,n)=>{var t;(t=n._primitiveBabylonMeshes)==null||t.forEach(r=>{r.isPickable=e})},getTarget:e=>e._babylonTransformNode,getPropertyName:[()=>"isPickable"],type:"boolean"});class I{constructor(n){this.name=s,this._loader=n,this.enabled=n.isExtensionUsed(s)}async onReady(){var n;(n=this._loader.gltf.nodes)==null||n.forEach(t=>{var r,i,c;(r=t.extensions)!=null&&r.KHR_node_selectability&&((i=t.extensions)==null?void 0:i.KHR_node_selectability.selectable)===!1&&((c=t._babylonTransformNode)==null||c.getChildMeshes().forEach(o=>{o.isPickable=!1}))})}dispose(){this._loader=null}}_(s);h(s,!0,e=>new I(e));export{I as KHR_node_selectability};
