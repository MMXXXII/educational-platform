import{Z as c,C as f}from"./sceneFragmentDeclaration-CNWtVIbJ.js";import{G as l}from"./glTFLoader-BlBnIl-i.js";import{u as m,r as d}from"./model-viewer-CRf71ZHW.js";import"./objectModelMapping-DZbRXB0J.js";import"./with-props-CdbLO-WJ.js";import"./chunk-AYJ5UCUI-B1579ApN.js";import"./waterMaterial-DHEJP-Do.js";const o="KHR_materials_diffuse_transmission";class T{constructor(e){this.name=o,this.order=174,this._loader=e,this.enabled=this._loader.isExtensionUsed(o),this.enabled&&(e.parent.transparencyAsCoverage=!0)}dispose(){this._loader=null}loadMaterialPropertiesAsync(e,u,n){return l.LoadExtensionAsync(e,u,this.name,(r,s)=>{const i=new Array;return i.push(this._loader.loadMaterialPropertiesAsync(e,u,n)),i.push(this._loadTranslucentPropertiesAsync(r,u,n,s)),Promise.all(i).then(()=>{})})}_loadTranslucentPropertiesAsync(e,u,n,r){if(!(n instanceof c))throw new Error(`${e}: Material type not supported`);const s=n;if(s.subSurface.isTranslucencyEnabled=!0,s.subSurface.volumeIndexOfRefraction=1,s.subSurface.minimumThickness=0,s.subSurface.maximumThickness=0,s.subSurface.useAlbedoToTintTranslucency=!1,r.diffuseTransmissionFactor!==void 0)s.subSurface.translucencyIntensity=r.diffuseTransmissionFactor;else return s.subSurface.translucencyIntensity=0,s.subSurface.isTranslucencyEnabled=!1,Promise.resolve();const i=new Array;return s.subSurface.useGltfStyleTextures=!0,r.diffuseTransmissionTexture&&(r.diffuseTransmissionTexture.nonColorData=!0,i.push(this._loader.loadTextureInfoAsync(`${e}/diffuseTransmissionTexture`,r.diffuseTransmissionTexture).then(a=>{a.name=`${n.name} (Diffuse Transmission)`,s.subSurface.translucencyIntensityTexture=a}))),r.diffuseTransmissionColorFactor!==void 0?s.subSurface.translucencyColor=f.FromArray(r.diffuseTransmissionColorFactor):s.subSurface.translucencyColor=f.White(),r.diffuseTransmissionColorTexture&&i.push(this._loader.loadTextureInfoAsync(`${e}/diffuseTransmissionColorTexture`,r.diffuseTransmissionColorTexture).then(a=>{a.name=`${n.name} (Diffuse Transmission Color)`,s.subSurface.translucencyColorTexture=a})),Promise.all(i).then(()=>{})}}m(o);d(o,!0,t=>new T(t));export{T as KHR_materials_diffuse_transmission};
