import{w as q}from"./with-props-CdbLO-WJ.js";import{a as M,o as g}from"./chunk-AYJ5UCUI-B1579ApN.js";import{E as W,S as $,C as f,M as k,F as N,V as S,a as Y,A as X,H as AA,b as w,c as eA,T as nA}from"./sceneFragmentDeclaration-CNWtVIbJ.js";const tA=({antialias:x,engineOptions:p,adaptToDeviceRatio:t,sceneOptions:E,onRender:y,onSceneReady:B,onMouseClick:I,...L})=>{const h=M.useRef(null);return M.useEffect(()=>{const{current:i}=h;if(!i)return;const j=new W(i,x,p,t),r=new $(j,E);r.isReady()?B(r):r.onReadyObservable.addOnce(l=>B(l)),j.runRenderLoop(()=>{typeof y=="function"&&y(r),r.render()}),typeof I=="function"&&i.addEventListener("click",function(l){I(l)}),typeof onKeyDown=="function"&&i.addEventListener("keydown",function(l){onKeyDown(l)});const u=()=>{r.getEngine().resize()};return window&&window.addEventListener("resize",u),()=>{r.getEngine().dispose(),window&&window.removeEventListener("resize",u)}},[x,p,t,E,y,B]),g.jsx("canvas",{ref:h,...L})},oA="/assets/skybox_px-BSqOAiL4.jpg",iA="/assets/skybox_py-CTloezgI.jpg",rA="/assets/skybox_pz-Byrz5A6E.jpg",lA="/assets/skybox_nx-CeGw7wW_.jpg",aA="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wCEAAUEBAQEAwUEBAQGBQUGCA0ICAcHCBALDAkNExAUExIQEhIUFx0ZFBYcFhISGiMaHB4fISEhFBkkJyQgJh0gISABBQYGCAcIDwgIDyAVEhUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIP/CABEIAgACAAMBIgACEQEDEQH/xAAVAAEBAAAAAAAAAAAAAAAAAAAAB//aAAgBAQAAAACPgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/xAAVAQEBAAAAAAAAAAAAAAAAAAAABf/aAAgBAhAAAACgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/xAAVAQEBAAAAAAAAAAAAAAAAAAAABP/aAAgBAxAAAACcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf/xAAUEAEAAAAAAAAAAAAAAAAAAADA/9oACAEBAAE/AAAH/8QAFBEBAAAAAAAAAAAAAAAAAAAAoP/aAAgBAgEBPwAAH//EABQRAQAAAAAAAAAAAAAAAAAAAKD/2gAIAQMBAT8AAB//2Q==",sA="/assets/skybox_nz-B3fh45CU.jpg";function uA(){var x=0;const p=768;var t=20,E=5;const[y,B]=M.useState(1),[I,L]=M.useState(0),h=()=>{let e=Array(E);for(let A=0;A<E;A++){e[A]=new Array(t);for(let n=0;n<t;n++)e[A][n]=new Array(t).fill(0)}return e},[i,j]=M.useState(h);console.log(i);var r=[],u=null,l=null,v=null,Q=null,T=null,R=null;const b=function(e){r=[null];let A=new w(e);return A.alpha=1,A.diffuseColor=new f(0,1,0),r.push(A),A=new w(e),A.alpha=1,A.diffuseColor=new f(1,.7,0),r.push(A),A=new w(e),A.alpha=1,A.diffuseColor=new f(0,0,1),r.push(A),A=new w(e),A.alpha=1,A.diffuseColor=new f(1,0,0),r.push(A),r.push(null),r.push(null),r},P=function(e,A=null){return A==null&&(A=new N("camera1",new S(t/2,40,t/2),e)),A.setTarget(new S(t/2,0,t/2)),A.rotation.y=0,A.mode=Y.ORTHOGRAPHIC_CAMERA,A.orthoTop=t/2,A.orthoBottom=-20/2,A.orthoRight=t/2,A.orthoLeft=-20/2,A},m=function(e,A=null){return A==null&&(A=new X("camera2",-2,1.4,20,new S(t/2,0,t/2),e)),A},O=function(e){let A=new AA("light",new S(.35,1,-.55),e);return A.intensity=1,A.specular=new f(0,0,0),A},U=function(e){e.intensity==1?(e.intensity=.9,e.specular=new f(1,.9,.8)):(e.intensity=1,e.specular=new f(0,0,0))},H=function(e){let A=k.CreateBox("skybox",{size:1e3},e),n=new w("skybox",e);return n.backFaceCulling=!1,n.reflectionTexture=new eA("",e,void 0,void 0,[oA,iA,rA,lA,aA,sA]),n.reflectionTexture.coordinatesMode=nA.SKYBOX_MODE,n.diffuseColor=new f(0,0,0),n.specularColor=new f(0,0,0),A.material=n,A},F=function(e,A,n){n.activeCamera==e?(n.activeCamera=A,A.attachControl(n)):(n.activeCamera=e,A.detachControl(n))},z=function(e,A,n,o,a){if(i[n][A][e]==o)return null;if(o==0)return i[n][A][e]=o,a.removeMesh(a.getMeshByName("tileX"+e+"Y"+A+"level"+n)),null;{if(i[n][A][e]!=o&&z(e,A,n,0,a),o==5){for(let s=0;s<E;s++)for(let C=0;C<t;C++)for(let d=0;d<t;d++)i[s][C][d]==o&&(i[s][C][d]=0);return i[n][A][e]=o,_(e,t-A,n,a)}if(o==6){for(let s=0;s<E;s++)for(let C=0;C<t;C++)for(let d=0;d<t;d++)i[s][C][d]==o&&(i[s][C][d]=0);return i[n][A][e]=o,G(e,t-A,n,a)}i[n][A][e]=o;let c=k.CreateBox("tileX"+e+"Y"+A+"level"+n,{size:1},a);return c.position.x=e+.5,c.position.z=t-A-.5,c.position.y=n,c.material=r[o],c}},G=function(e,A,n,o){return u==null&&(u=k.CreateSphere("player",{diameter:1,segments:32},o)),u.position.y=n,u.position.x=e+.5,u.position.z=A-.5,u.destination={position:{x:e+.5,y:n,z:A-.5}},u},_=function(e,A,n,o){l==null&&(l=k.CreateBox("exit",{size:.6,segments:32},o));let a=new w(o);return a.alpha=.7,a.diffuseColor=new f(1,0,0),l.material=a,l.position.y=n,l.position.x=e+.5,l.position.z=A-.5,l},D=function(e){let A=e.layerX,n=e.layerY;A=Math.floor(A/(p/t)),n=Math.floor(n/(p/t)),v.activeCamera.name=="camera1"&&(e.altKey?z(A,n,I,0,v):z(A,n,I,y,v))},V=function(e){e.key==" "&&(F(Q,T,v),U(R))},K=e=>{Q=P(e),T=m(e),R=O(e),H(e),b(e),v=e},J=e=>{l&&(l.rotation.y=x*.006,l.rotation.x=x*.007,l.rotation.z=x*.008),x+=1},Z=function(){let e=JSON.stringify(i,null,4);function A(n,o,a){var c=document.createElement("a"),s=new Blob([n],{type:a});c.href=URL.createObjectURL(s),c.download=o,c.click()}A(e,"exampleMap.json","text/plain"),console.log(e)};return g.jsxs("div",{children:[g.jsx(tA,{antialias:!0,onSceneReady:K,onRender:J,id:"renderCanvas",onMouseClick:D,onKeyDown:V}),g.jsx("label",{children:"ЧЕМ КРАСИТЬ"}),g.jsx("input",{type:"number",value:y,onChange:e=>B(e.target.value)}),g.jsx("button",{onClick:Z,className:"px-4 pu-2 bg-blue-500 hover:bg-blue-600 text-white rounded-md cursor-pointer",children:"Экспортировать сцену"})]})}function dA({}){return[{title:"Редактор"},{name:"description",content:"Создавайте свои карты"}]}const xA=q(function(){return g.jsx(uA,{})});export{xA as default,dA as meta};
